<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Upload and Display Videos with Firebase</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            margin: 20px;
        }
        .upload-container {
            margin-bottom: 20px;
        }
        video {
            max-width: 100%;
            height: auto;
            margin-top: 20px;
        }
        .video-link {
            margin-top: 20px;
        }
    </style>
    <!-- Firebase App (the core Firebase SDK) is always required and must be listed first -->
    <script type="module">
        // Import the functions you need from the SDKs you need
        import { initializeApp } from "https://www.gstatic.com/firebasejs/10.12.3/firebase-app.js";
        import { getStorage, ref, uploadBytesResumable, getDownloadURL } from "https://www.gstatic.com/firebasejs/10.12.3/firebase-storage.js";

        // Your web app's Firebase configuration
        const firebaseConfig = {
            apiKey: "AIzaSyDOq-QUoAav6TV72BCGbSdCJjyb2pcuV_E",
            authDomain: "upload-video-cbc58.firebaseapp.com",
            projectId: "upload-video-cbc58",
            storageBucket: "upload-video-cbc58.appspot.com",
            messagingSenderId: "962019643419",
            appId: "1:962019643419:web:cefbebb66c573ae840e8be",
            measurementId: "G-41RW7EEPBP"
        };

        // Initialize Firebase
        const app = initializeApp(firebaseConfig);
        const storage = getStorage(app);

        // Function to handle video upload
        function uploadVideo() {
            const fileInput = document.getElementById('videoUpload');
            const file = fileInput.files[0];
            if (file) {
                const storageRef = ref(storage, 'videos/' + file.name);
                const uploadTask = uploadBytesResumable(storageRef, file);

                uploadTask.on('state_changed', 
                    (snapshot) => {
                        // Handle progress
                        const progress = (snapshot.bytesTransferred / snapshot.totalBytes) * 100;
                        console.log('Upload is ' + progress + '% done');
                    },
                    (error) => {
                        // Handle unsuccessful uploads
                        console.error('Upload failed:', error);
                    },
                    () => {
                        // Handle successful uploads on complete
                        getDownloadURL(uploadTask.snapshot.ref).then((downloadURL) => {
                            // Display the video
                            const videoPlayer = document.getElementById('videoPlayer');
                            videoPlayer.src = downloadURL;
                            videoPlayer.load();
                            videoPlayer.play();

                            // Display the video link
                            const videoLink = document.getElementById('videoLink');
                            videoLink.href = downloadURL;
                            videoLink.textContent = downloadURL;
                            document.getElementById('videoLinkContainer').style.display = 'block';
                        });
                    }
                );
            } else {
                console.error('No file selected');
            }
        }
    </script>
</head>
<body>
    <h1>Upload and Display Videos with Firebase</h1>
    <div class="upload-container">
        <input type="file" id="videoUpload" accept="video/*">
        <button onclick="uploadVideo()">Upload Video</button>
    </div>
    <video id="videoPlayer" controls></video>
    <div class="video-link" id="videoLinkContainer" style="display: none;">
        <p>Video URL: <a id="videoLink" href="#" target="_blank"></a></p>
    </div>
</body>
</html>
